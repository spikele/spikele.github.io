<!DOCTYPE html>
<html>
  <head>
    <title></title>
    <style>
      .nav {
        position:static;
        top:0;
        left:0;
        width:100%;
        min-height:30px;
        background-color:#f3f3f3;
        border-bottom: 1px solid #eee;
        margin:0;
        padding:0 0 0 30px;
      }
      .nav > li span {
        width:30%;
        min-width: 300px;
        display: inline-block;
        vertical-align: top;
      }
      .nav > li > a {
        padding:0 20px;
        line-height:24px;
        display: block;
        color:black;
        text-decoration: none;
      }
      .nav > li:nth-child(2n+1) {
        background-color: rgba(255,255,255,.8);
      }
      .nav > li:hover {
        background-color: rgba(0,0,0,.2);
      }

      .nav > li.loaded span {
        font-weight:900;
        text-transform: uppercase;
      }
      .nav > li.error {
        color:white;
        background-color: red;
      }
      .heading {
        text-align:center;
        border-bottom:1px solid gray;
        clear:both;
        margin-top: 60px;
      }
      #results a:nth-child(2) {
        float:right;
      }
      iframe {
        border:none;
        width:100%;
        height: 1200px;
      }
      .LstatusT {
        color:#00CC00;
      }
      .LstatusF {
        color:#CC0000;
      }      
      
    </style>
  </head>
  <body>
  	
  	<img id="dot" src="http://4.bp.blogspot.com/_wWmWqyCEKEs/TSEQUbgrQZI/AAAAAAAADuQ/nle2R79B7Tw/s200/old_employee.png" alt="dot" align="right">
  
  <h3>Number of Successes:</h3> 
  <p id="Successes"></p>  
  <p id="L1">Lead1(ComingUp)</p><p id="L2">Lead2(Today)</p><p id="L3">Lead3(Hanging)</p>
  <br>
  	
  	
  	<ol class="nav" id="nav"></ol>
    <div id="results"></div>
  	
  	<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
  	<script>
  	var Successes = 0;
  	var ID1 ='test1';
  	var ID2 ='test2';
    var ID3 ='test3'
    
    var d = new Date();
    
        var today = new Date();
        var dd = today.getDate();
        var mm = today.getMonth()+1;
        var yyyy = today.getFullYear();
            if(dd<10) {
            dd='0'+dd
            } 
            if(mm<10) {
            mm='0'+mm
            } 
        today = yyyy+'-'+mm+'-'+dd+'T00:00:00';
        document.write(today);
  	
  	var data1 = [
  	{'url':'http://devapidb.cloudapp.net:8863/0.0.1/web/leads/?api_key=1234asdf23t523f5ya', 'elId':'Create Lead1' ,'METHOD': 'POST', 'DATA':{"Title": "Intersting Dev Project", "Description": "something about maps, payment and instagram for pets. Its going to drive conversion and customer retention", "Scheduled": "2015-01-01T01:01:01"}},
  	{'url':'http://devapidb.cloudapp.net:8863/0.0.1/web/leads/?api_key=1234asdf23t523f5ya', 'elId':'Create Lead2' ,'METHOD': 'POST', 'DATA':{"Title": "Intersting Dev Project", "Description": "something about maps, payment and instagram for pets. Its going to drive conversion and customer retention", "Scheduled": today}},
    {'url':'http://devapidb.cloudapp.net:8863/0.0.1/web/leads/?api_key=1234asdf23t523f5ya', 'elId':'Create Lead3' ,'METHOD': 'POST', 'DATA':{"Title": "Intersting Dev Project", "Description": "something about maps, payment and instagram for pets. Its going to drive conversion and customer retention", "Scheduled": "2013-01-01T01:01:01"}}
  	]
  	
  	
  	data1.forEach(function(p) {
  	
  	    p.$el = $('<div id="'+p.elId+'"><h1 class="heading">'+p.elId+'</h1><a href="#">to top</a><div class="result"></div></div>');
        $("#results").append(p.$el);
        p.$link = $('<li><a href="#'+ p.elId+'"><span>'+ p.elId +'</span>('+ p.url +')</a></li>');
        $("#nav").append(p.$link);
    
    
    
  	$.ajax({
  	  url: p.url,
  	  method: (p.METHOD),
  	  type: 'json',
  	  async: false,
  	  data: (p.DATA)
  	  
  	}).done(function(resp) {
  	  if(!resp)return;
  	  Successes++
  	  if(p.elId == 'Create Lead1'){ID1 = resp.id;}
  	  else if (p.elId == 'Create Lead2'){ID2 = resp.id}
  	  else {ID3 = resp.id};
  	  
  	  if (p.elId == 'Create Lead1' && resp.status == "ComingUp") {$(document.getElementById("L1")).addClass('LstatusT')}
      else if(p.elId == 'Create Lead1') {$(document.getElementById("L1")).addClass('LstatusF')};
      if (p.elId == 'Create Lead2' && resp.status == "Today") {$(document.getElementById("L2")).addClass('LstatusT')}
      else if(p.elId == 'Create Lead2') {$(document.getElementById("L2")).addClass('LstatusF')};
      if (p.elId == 'Create Lead3' && resp.status == "Hanging") {$(document.getElementById("L3")).addClass('LstatusT')}
      else if(p.elId == 'Create Lead3') {$(document.getElementById("L3")).addClass('LstatusF')};
      p.$link.addClass('loaded');
  	  $("<pre></pre>").appendTo(p.$el).text(JSON.stringify(resp, undefined, 2));
  	  
  	  
  	  
  	}).fail(function(resp, status, msg) {
              var fullContent = resp.responseText.replace(/\n/g, '').replace(/\>\s+\</g, '><');
              var head = (fullContent.match(/\<head[^\>]*\>(.*)\<\/head\>/) || ['',''])[1];
              var body = (fullContent.match(/\<body[^\>]*\>(.*)\<\/body\>/) || ['',''])[1];
              var _bodyAttr = (fullContent.match(/\<body([^\>]*)\>/) || ['',''])[1];
              var bodyAttr = {};
              var iframe = $("<iframe>");
          tlink.addClass('error');        
      })
    })
    
    
    
    
  	var data = [
  	{'url':'http://devapidb.cloudapp.net:8863/0.0.1/web/config/?api_key=1234asdf23t523f5ya', 'elId': 'Config','METHOD': 'GET'},
  	{'url':'http://devapidb.cloudapp.net:8863/0.0.1/web/leads/' + ID1 + '/?api_key=1234asdf23t523f5ya', 'elId': 'Get Lead1', 'METHOD': 'GET'},
  	{'url':'http://devapidb.cloudapp.net:8863/0.0.1/web/leads/' + ID2 + '/?api_key=1234asdf23t523f5ya', 'elId': 'Get Lead2', 'METHOD': 'GET'},
  	{'url':'http://devapidb.cloudapp.net:8863/0.0.1/web/leads/' + ID3 + '/?api_key=1234asdf23t523f5ya', 'elId': 'Get Lead3', 'METHOD': 'GET'},
  	{'url':'http://devapidb.cloudapp.net:8863/0.0.1/web/leads/?api_key=1234asdf23t523f5ya', 'elId': 'Edit Lead', 'METHOD': 'PUT', 'DATA': {"id":"leads/1","title":"Very Intersting Dev Project","created":"0001-01-01T00:00:00","phase":0,"status":0,"events":[{"id":"d08bce8d-4323-4a56-ba8b-f6a1df029e28","created":"2014-06-23T10:26:47","scheduled":"0001-01-01T00:00:00","type":0,"notes":"something about maps, payment and instagram for pets. Its going to drive conversion and customer retention","subject":null}],"contacts":null}},
  	{'url':'http://devapidb.cloudapp.net:8863/0.0.1/web/leads/hanging?api_key=1234asdf23t523f5ya&limit=10&offset=0', 'elId': 'Hanging Leads', 'METHOD': 'GET', 'DATA': {"id":"leads/1","title":"Very Intersting Dev Project","created":"0001-01-01T00:00:00","phase":0,"status":0,"events":[{"id":"d08bce8d-4323-4a56-ba8b-f6a1df029e28","created":"2014-06-23T10:26:47","scheduled":"0001-01-01T00:00:00","type":0,"notes":"something about maps, payment and instagram for pets. Its going to drive conversion and customer retention","subject":null}],"contacts":null}},
  	{'url':'http://devapidb.cloudapp.net:8863/0.0.1/web/leads/comingup?api_key=1234asdf23t523f5ya&limit=10&offset=0', 'elId': 'Coming up Leads', 'METHOD': 'GET', 'DATA': {"id":"leads/1","title":"Very Intersting Dev Project","created":"0001-01-01T00:00:00","phase":0,"status":0,"events":[{"id":"d08bce8d-4323-4a56-ba8b-f6a1df029e28","created":"2014-06-23T10:26:47","scheduled":"0001-01-01T00:00:00","type":0,"notes":"something about maps, payment and instagram for pets. Its going to drive conversion and customer retention","subject":null}],"contacts":null}},
  	{'url':'http://devapidb.cloudapp.net:8863/0.0.1/web/leads/today?api_key=1234asdf23t523f5ya&limit=10&offset=0', 'elId': 'Todays Leads', 'METHOD': 'GET', 'DATA': {"id":"leads/1","title":"Very Intersting Dev Project","created":"0001-01-01T00:00:00","phase":0,"status":0,"events":[{"id":"d08bce8d-4323-4a56-ba8b-f6a1df029e28","created":"2014-06-23T10:26:47","scheduled":"0001-01-01T00:00:00","type":0,"notes":"something about maps, payment and instagram for pets. Its going to drive conversion and customer retention","subject":null}],"contacts":null}},
  	{'url':'http://devapidb.cloudapp.net:8863/0.0.1/web/leads/' + ID1 + '/?api_key=1234asdf23t523f5ya', 'elId': 'Lead Delete1', 'METHOD': 'DELETE'},
  	{'url':'http://devapidb.cloudapp.net:8863/0.0.1/web/leads/' + ID2 + '/?api_key=1234asdf23t523f5ya', 'elId': 'Lead Delete2', 'METHOD': 'DELETE'},
  	{'url':'http://devapidb.cloudapp.net:8863/0.0.1/web/leads/' + ID3 + '/?api_key=1234asdf23t523f5ya', 'elId': 'Lead Delete3', 'METHOD': 'DELETE'}
  	];
  	
  	var URLsInData = 0
            data.forEach(function(p){
                if (p.url){
                    URLsInData++;
                }
            })     
    var URLsInData1 = 0
            data1.forEach(function(p){
                if (p.url){
                    URLsInData1++;
                }
            })          
               
   var numEndpoints = URLsInData + URLsInData1
   
  	data.forEach(function(p){
            p.$el = $('<div id="'+p.elId+'"><h1 class="heading">'+p.elId+'</h1><a href="#">to top</a><div class="result"></div></div>');
            $("#results").append(p.$el);
            p.$link = $('<li><a href="#'+ p.elId+'"><span>'+ p.elId +'</span>('+ p.url +')</a></li>');
            $("#nav").append(p.$link);
               
            
            $.ajax({
              url: p.url,
              method: (p.METHOD),
              type: 'json',
              data: (p.DATA)
            }).done(function(resp) {
              if(!resp && p.elId != 'Lead Delete1' && p.elId != 'Lead Delete2' && p.elId != 'Lead Delete3')return;
              $("<pre></pre>").appendTo(p.$el).text(JSON.stringify(resp, undefined, 2));
             
                function addLoadedClass() {
                    p.$link.addClass('loaded');
                    Successes++;
                    document.getElementById("Successes").innerHTML=Successes+'/'+numEndpoints;
                    if (Successes >= URLsInData + URLsInData1) {
                        var image = document.getElementById("dot");
                        image.src = "http://www.thepointless.com/images/greendot.jpg";
                    }
                }
              
                addLoadedClass()
                
			    
              
            }).fail(function(resp, status, msg) {
              var fullContent = resp.responseText.replace(/\n/g, '').replace(/\>\s+\</g, '><');
              var head = (fullContent.match(/\<head[^\>]*\>(.*)\<\/head\>/) || ['',''])[1];
              var body = (fullContent.match(/\<body[^\>]*\>(.*)\<\/body\>/) || ['',''])[1];
              var _bodyAttr = (fullContent.match(/\<body([^\>]*)\>/) || ['',''])[1];
              var bodyAttr = {};
              var iframe = $("<iframe>");
              
              	function addErrorClass() {
                    p.$link.addClass('error');
                    var image = document.getElementById("dot"); 
                    image.src = "http://www.thepointless.com/images/reddot.jpg";
                }
                
                addErrorClass()
            });
        });
  	</script>
  </body>
</html>